package org.firstinspires.ftc.teamcode.TeleOps;

import com.acmerobotics.dashboard.config.Config;
import java.util.TreeMap;

@Config
public class ShooterPowerTable {
    public static double DIST1 = 60.0;
    public static double POWER1 = 0.70;
    public static double DIST2 = 80.0;
    public static double POWER2 = 0.75;
    public static double DIST3 = 110.0;
    public static double POWER3 = 0.86;

    private final TreeMap<Double, Double> table = new TreeMap<>();

    //constructor for power table.
    //updateTable to reflect live dashboard tuning
    public ShooterPowerTable() {
        updateTable();
    }

    public void updateTable() {
        table.clear();
        table.put(DIST1, POWER1);
        table.put(DIST2, POWER2);
        table.put(DIST3, POWER3);
    }

    public double getPower(double distance) {
        updateTable(); // reflect live dashboard tuning

        Double lower = table.floorKey(distance);
        Double upper = table.ceilingKey(distance);

        if (lower == null) return table.firstEntry().getValue();
        if (upper == null) return table.lastEntry().getValue();
        if (lower.equals(upper)) return table.get(distance);

        double lowerVal = table.get(lower);
        double upperVal = table.get(upper);
        return lowerVal + (distance - lower) * (upperVal - lowerVal) / (upper - lower);
    }
}